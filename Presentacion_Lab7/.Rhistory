mutate(fecha = ymd(fecha))
data <- data %>%
mutate(dia = day(hora_final))
data <- data %>%
mutate(fecha = case_when(dia == 1 ~ fecha + ddays(x=1),
dia == 31 ~ fecha))
data <- data %>%
mutate(fecha_final = make_datetime(year(fecha),
month(fecha),
day(fecha),
hour(hora_final),
minute(hora_final),
second(hora_final)))
data <- data %>%
select(-c("fecha", "fechaF1", "fechaF2", "hora_final", "dia"))
preg <- data %>%
filter(call == 1) %>%
mutate(semana = floor_date(fecha_creacion, unit = "week")) %>%
group_by(semana) %>%
summarise(conteo = n())
kpss.test(preg[,2], null ="Trend") #si p>0.05 es estacionaria
View(preg)
preg <- data %>%
filter(call == 1) %>%
mutate(semana = floor_date(fecha_creacion, unit = "week")) %>%
group_by(semana) %>%
summarise(conteo = n())
typeof(preg)
kpss.test(preg[,2], null ="Trend") #si p>0.05 es estacionaria
preg <- data %>%
filter(call == 1) %>%
mutate(semana = floor_date(fecha_creacion, unit = "week")) %>%
group_by(semana) %>%
summarise(conteo = n())
preg = unlist(preg)
kpss.test(preg[,2], null ="Trend") #si p>0.05 es estacionaria
?kpss.test
preg
preg <- data %>%
filter(call == 1) %>%
mutate(semana = floor_date(fecha_creacion, unit = "week")) %>%
group_by(semana) %>%
summarise(conteo = n())
preg = data.frame(preg)
preg
kpss.test(preg[,2], null ="Trend") #si p>0.05 es estacionaria
#No es estacionaria por poco
plumber::plumb(file='C:/Users/danie/Desktop/DataProduct-2022/Plumber/Lab2/Lab2.R')$run()
plumber::plumb(file='C:/Users/danie/Desktop/DataProduct-2022/Plumber/Lab2/Lab2.R')$run()
fit <- readRDS(gzcon(url("https://github.com/dan-behar/DataProduct-2022/blob/main/Plumber/modelo_entrenado.rds")))
fit <-gzcon(url("https://github.com/dan-behar/DataProduct-2022/blob/main/Plumber/modelo_entrenado.rds"))
fit
fit <-gzcon(url("https://github.com/dan-behar/DataProduct-2022/blob/main/Plumber/modelo_entrenado.rds?raw=true"))
fit <- gzcon(url("https://github.com/dan-behar/DataProduct-2022/blob/main/Plumber/modelo_entrenado.rds?raw=true"))
fit
fit <- readRDS(gzcon(url("https://github.com/dan-behar/DataProduct-2022/blob/main/Plumber/modelo_entrenado.rds?raw=true")))
View(fit)
data = read.csv("c1.csv")
library(dplyr)
setwd("C:/Users/danie/Desktop/DataWrangling-2022/Presentacion_Lab7")
data = read.csv("c1.csv")
View(data)
names(data) = tolower(names(data))
View(data)
data = data[-6]
View(data)
data = read.csv("c1.csv")
data = data[,-6]
View(data)
data = read.csv("c1.csv")
data = data[-c(23,24,25,26,27,28)]
names(data) = tolower(names(data))
names(data[4])
names(data) = gsub("_5", "", names(data))
View(data)
data = data %>% mutate(
camion = gsub("Q", "",camion),
camion = gsub("-", 0,camion),
pickup = gsub("Q", "",camion),
pickup = gsub("-", 0,camion),
moto = gsub("Q", "",camion),
moto = gsub("-", 0,camion)
)
data = read.csv("c1.csv")
data = read.csv("c1.csv")
data = data[-c(23,24,25,26,27,28)]
names(data) = tolower(names(data))
names(data) = gsub("_5", "", names(data))
data = data %>% mutate(
camion = gsub("Q", "",camion),
camion = gsub("-", 0,camion),
pickup = gsub("Q", "",pickup),
pickup = gsub("-", 0,pickup),
moto = gsub("Q", "",moto),
moto = gsub("-", 0,moto)
)
data = read.csv("c1.csv")
data = data[-c(23,24,25,26,27,28)]
names(data) = tolower(names(data))
names(data) = gsub("_5", "", names(data))
data = data %>% mutate(
camion = gsub("Q", "",camion),
camion = gsub("-", 0,camion),
pickup = gsub("Q", "",pickup),
pickup = gsub("-", 0,pickup),
moto = gsub("Q", "",moto),
moto = gsub("-", 0,moto),
directocamion = gsub("Q", "",directocamion),
directocamion = gsub("-", 0,directocamion),
directopickup = gsub("Q", "",directopickup),
directopickup = gsub("-", 0,directopickup),
directo = gsub("Q", "",directomoto),
directomoto = gsub("-", 0,directomoto),
fijocamion = gsub("Q", "",fijocamion),
fijocamion = gsub("-", 0,fijocamion),
fijopickup = gsub("Q", "",fijopickup),
fijopickup = gsub("-", 0,fijopickup),
fijomoto = gsub("Q", "",fijomoto),
fijomoto = gsub("-", 0,fijomoto)
)
data = read.csv("c1.csv")
data = data[-c(23,24,25,26,27,28)]
names(data) = tolower(names(data))
names(data) = gsub("_5", "", names(data))
data = data %>% mutate(
camion = gsub("Q", "",camion),
camion = gsub("-", 0,camion),
pickup = gsub("Q", "",pickup),
pickup = gsub("-", 0,pickup),
moto = gsub("Q", "",moto),
moto = gsub("-", 0,moto),
directocamion = gsub("Q", "",directocamion),
directocamion = gsub("-", 0,directocamion),
directopickup = gsub("Q", "",directopickup),
directopickup = gsub("-", 0,directopickup),
directodirecto = gsub("Q", "",directomoto),
directomoto = gsub("-", 0,directomoto),
fijocamion = gsub("Q", "",fijocamion),
fijocamion = gsub("-", 0,fijocamion),
fijopickup = gsub("Q", "",fijopickup),
fijopickup = gsub("-", 0,fijopickup),
fijomoto = gsub("Q", "",fijomoto),
fijomoto = gsub("-", 0,fijomoto)
)
data = read.csv("c1.csv")
data = data[-c(23,24,25,26,27,28)]
names(data) = tolower(names(data))
names(data) = gsub("_5", "", names(data))
data = data %>% mutate(
camion = gsub("Q", "",camion),
camion = gsub("-", 0,camion),
pickup = gsub("Q", "",pickup),
pickup = gsub("-", 0,pickup),
moto = gsub("Q", "",moto),
moto = gsub("-", 0,moto),
directocamion = gsub("Q", "",directocamion),
directocamion = gsub("-", 0,directocamion),
directopickup = gsub("Q", "",directopickup),
directopickup = gsub("-", 0,directopickup),
directomoto = gsub("Q", "",directomoto),
directomoto = gsub("-", 0,directomoto),
fijocamion = gsub("Q", "",fijocamion),
fijocamion = gsub("-", 0,fijocamion),
fijopickup = gsub("Q", "",fijopickup),
fijopickup = gsub("-", 0,fijopickup),
fijomoto = gsub("Q", "",fijomoto),
fijomoto = gsub("-", 0,fijomoto)
)
names(data) = gsub("x", "", names(data))
names(data) = gsub(".", "-", names(data))
data = read.csv("c1.csv")
data = data[-c(23,24,25,26,27,28)]
names(data) = tolower(names(data))
names(data) = gsub("_5", "", names(data))
names(data) = gsub("x", "", names(data))
data = data %>% mutate(
camion = gsub("Q", "",camion),
camion = gsub("-", 0,camion),
pickup = gsub("Q", "",pickup),
pickup = gsub("-", 0,pickup),
moto = gsub("Q", "",moto),
moto = gsub("-", 0,moto),
directocamion = gsub("Q", "",directocamion),
directocamion = gsub("-", 0,directocamion),
directopickup = gsub("Q", "",directopickup),
directopickup = gsub("-", 0,directopickup),
directomoto = gsub("Q", "",directomoto),
directomoto = gsub("-", 0,directomoto),
fijocamion = gsub("Q", "",fijocamion),
fijocamion = gsub("-", 0,fijocamion),
fijopickup = gsub("Q", "",fijopickup),
fijopickup = gsub("-", 0,fijopickup),
fijomoto = gsub("Q", "",fijomoto),
fijomoto = gsub("-", 0,fijomoto)
)
data %>% summarise(camion)
data %>% summarise(count(camion))
data %>% summarise(group_by(codigo))
data %>% summarise(group_by(cod))
library(dplyr)
data %>% summarise(group_by(cod))
data %>% group_by(cod) %>% summarise(n = n()) %>% arrange(n)
library(highcharter)
data %>% group_by(cod) %>% summarise(n = n()) %>% arrange(n)
highchart(type = "stock") %>%
hc_add_series(factura,
type = "line",
color = "green")
highchart(type = "stock") %>%
hc_add_series(data$factura,
type = "line",
color = "green")
highchart(type = "stock") %>%
hc_add_series(data$factura, type = "column")
data %>% group_by(cod) %>% summarise(n = n()) %>% arrange(n) %>%
hchart(type = "column")
data %>% group_by(cod) %>% summarise(n = n()) %>% arrange(n) %>%
hchart(type = "column", hcaes(x = cod, y = n))
data %>% group_by(cod) %>% summarise(ganancias = sum(factura)) %>% arrange(ganancias) %>%
highchart() %>% hc_add_series(pokemon, "scatter", hcaes(x = height, y = weight))
data$factura = as.numeric(factura)
data$factura = as.numeric(data$factura)
a
data = read.csv("c1.csv")
data = data[-c(23,24,25,26,27,28)]
names(data) = tolower(names(data))
names(data) = gsub("_5", "", names(data))
names(data) = gsub("x", "", names(data))
data = data %>% mutate(
camion = gsub("Q", "",camion),
camion = gsub("-", 0,camion),
pickup = gsub("Q", "",pickup),
pickup = gsub("-", 0,pickup),
moto = gsub("Q", "",moto),
moto = gsub("-", 0,moto),
directocamion = gsub("Q", "",directocamion),
directocamion = gsub("-", 0,directocamion),
directopickup = gsub("Q", "",directopickup),
directopickup = gsub("-", 0,directopickup),
directomoto = gsub("Q", "",directomoto),
directomoto = gsub("-", 0,directomoto),
fijocamion = gsub("Q", "",fijocamion),
fijocamion = gsub("-", 0,fijocamion),
fijopickup = gsub("Q", "",fijopickup),
fijopickup = gsub("-", 0,fijopickup),
fijomoto = gsub("Q", "",fijomoto),
fijomoto = gsub("-", 0,fijomoto)
)
data = data %>% mutate(
camion = gsub("Q", "",camion),
camion = gsub("-", 0,camion),
pickup = gsub("Q", "",pickup),
pickup = gsub("-", 0,pickup),
moto = gsub("Q", "",moto),
moto = gsub("-", 0,moto),
directocamion = gsub("Q", "",directocamion),
directocamion = gsub("-", 0,directocamion),
directopickup = gsub("Q", "",directopickup),
directopickup = gsub("-", 0,directopickup),
directomoto = gsub("Q", "",directomoto),
directomoto = gsub("-", 0,directomoto),
fijocamion = gsub("Q", "",fijocamion),
fijocamion = gsub("-", 0,fijocamion),
fijopickup = gsub("Q", "",fijopickup),
fijopickup = gsub("-", 0,fijopickup),
fijomoto = gsub("Q", "",fijomoto),
fijomoto = gsub("-", 0,fijomoto)
factura = gsub("Q", "", factura)
)
data = data %>% mutate(
camion = gsub("Q", "",camion),
camion = gsub("-", 0,camion),
pickup = gsub("Q", "",pickup),
pickup = gsub("-", 0,pickup),
moto = gsub("Q", "",moto),
moto = gsub("-", 0,moto),
directocamion = gsub("Q", "",directocamion),
directocamion = gsub("-", 0,directocamion),
directopickup = gsub("Q", "",directopickup),
directopickup = gsub("-", 0,directopickup),
directomoto = gsub("Q", "",directomoto),
directomoto = gsub("-", 0,directomoto),
fijocamion = gsub("Q", "",fijocamion),
fijocamion = gsub("-", 0,fijocamion),
fijopickup = gsub("Q", "",fijopickup),
fijopickup = gsub("-", 0,fijopickup),
fijomoto = gsub("Q", "",fijomoto),
fijomoto = gsub("-", 0,fijomoto),
factura = gsub("Q", "", factura)
)
data$factura = as.numeric(data$factura)
data %>% group_by(cod) %>% summarise(ganancias = sum(factura)) %>% arrange(ganancias) %>%
highchart() %>% hc_add_series(pokemon, "scatter", hcaes(x = height, y = weight))
data %>% group_by(cod) %>% summarise(ganancias = sum(factura)) %>% arrange(ganancias) %>%
highchart() %>% hc_add_series(pokemon, "scatter", hcaes(x = cod, y = ganancias))
data %>% group_by(cod) %>% summarise(ganancias = sum(factura)) %>% arrange(ganancias) %>%
highchart() %>% hc_add_series(pokemon, "scatter", hcaes(x = data$cod, y = data$ganancias))
data %>% group_by(cod) %>% summarise(ganancias = sum(factura)) %>% arrange(ganancias) %>%
hchart(type = "column", hcaes(x = cod, y = ganancias))
data %>% group_by(cod) %>% summarise(n = n()) %>% arrange(n) %>%
hchart(type = "column", hcaes(x = cod, y = n))
data %>% group_by(cod) %>% summarise(ganancias = sum(factura)) %>% arrange(ganancias) %>%
hchart(type = "column", hcaes(x = cod, y = ganancias))
data$factura = as.numeric(data$factura)
data$camion = as.numeric(data$camion)
data$pickup = as.numeric(data$pickup)
data$moto = as.numeric(data$moto)
data$directocamion = as.numeric(data$directocamion)
data$directopickup = as.numeric(data$directopickup)
data$directomoto = as.numeric(data$directomoto)
data$fijocamion = as.numeric(data$fijocamion)
data$fijopickup = as.numeric(data$fijopickup)
data$fijomoto = as.numeric(data$fijomoto)
data$Profit = data$factura - data$camion - data$pickup - data$moto
highchart() %>%
hc_yAxis_multiples(
list(lineWidth = 3),
list(showLastLabel = FALSE, opposite = TRUE)
) %>%
hc_add_series(data = data$profit) %>%
hc_add_series(data = data$factura, type = "spline", yAxis = 1)
highchart() %>%
hc_yAxis_multiples(
list(lineWidth = 3),
list(showLastLabel = FALSE, opposite = TRUE)
) %>%
hc_add_series(data = data$factura) %>%
hc_add_series(data = data$profit, type = "spline", yAxis = 1)
hchart(
'line', hcaes(x = cod, y = profit),
color = "steelblue"
)
data = read.csv("c1.csv")
data = data[-c(23,24,25,26,27,28)]
names(data) = tolower(names(data))
names(data) = gsub("_5", "", names(data))
names(data) = gsub("x", "", names(data))
data = data %>% mutate(
camion = gsub("Q", "",camion),
camion = gsub("-", 0,camion),
pickup = gsub("Q", "",pickup),
pickup = gsub("-", 0,pickup),
moto = gsub("Q", "",moto),
moto = gsub("-", 0,moto),
directocamion = gsub("Q", "",directocamion),
directocamion = gsub("-", 0,directocamion),
directopickup = gsub("Q", "",directopickup),
directopickup = gsub("-", 0,directopickup),
directomoto = gsub("Q", "",directomoto),
directomoto = gsub("-", 0,directomoto),
fijocamion = gsub("Q", "",fijocamion),
fijocamion = gsub("-", 0,fijocamion),
fijopickup = gsub("Q", "",fijopickup),
fijopickup = gsub("-", 0,fijopickup),
fijomoto = gsub("Q", "",fijomoto),
fijomoto = gsub("-", 0,fijomoto),
factura = gsub("Q", "", factura)
)
data$factura = as.numeric(data$factura)
data$camion = as.numeric(data$camion)
data$pickup = as.numeric(data$pickup)
data$moto = as.numeric(data$moto)
data$directocamion = as.numeric(data$directocamion)
data$directopickup = as.numeric(data$directopickup)
data$directomoto = as.numeric(data$directomoto)
data$fijocamion = as.numeric(data$fijocamion)
data$fijopickup = as.numeric(data$fijopickup)
data$fijomoto = as.numeric(data$fijomoto)
data %>% group_by(cod) %>% summarise(n = n()) %>% arrange(n) %>%
hchart(type = "column", hcaes(x = cod, y = n))
data %>% group_by(cod) %>% summarise(facturado = sum(factura)) %>% arrange(ganancias) %>%
hchart(type = "column", hcaes(x = cod, y = ganancias))
data <- data %>%
mutate(marge_venta = (factura - (Camion_5 + Pickup + Moto)))
data <- data %>%
mutate(marge_venta = (factura - (camion + pickup + moto)))
data <- data %>%
mutate(marge_venta_porcostos = (factura - (fijocamion + directocamion+ fijopickup +directopickup+ fijomoto+ directomoto)))
ay <- list(
tickfont = list(color = "orange"),
overlaying = "y",
side = "right",
title = "Total"
)
plot_ly(
data= data %>%
select(Cod,marge_venta) %>%
group_by(Cod) %>%
summarise(cantidad = n()),
x=~Cod,
y=~cantidad,
type="bar",
name="Viajes"
) %>%
add_trace(
data=data %>%
select(Cod,marge_venta) %>%
group_by(Cod) %>%
summarise(margen_venta = mean(marge_venta)),
x=~Cod,
y=~margen_venta,
type="scatter",
mode="lines+markers",
name="margen_venta",
yaxis="y2"
) %>%
layout(yaxis = list(title = 'Count'),
yaxis2 = ay)
plot_ly(
data= data %>%
select(Cod,marge_venta) %>%
group_by(Cod) %>%
summarise(cantidad = n()),
x=~Cod,
y=~cantidad,
type="bar",
name="Viajes"
) %>%
add_trace(
data=data %>%
select(Cod,marge_venta) %>%
group_by(Cod) %>%
summarise(margen_venta = mean(marge_venta)),
x=~Cod,
y=~margen_venta,
type="scatter",
mode="lines+markers",
name="margen_venta",
yaxis="y2"
) %>%
layout(yaxis = list(title = 'Count'),
yaxis2 = ay)
plot_ly(
data= data %>%
select(Cod,marge_venta) %>%
group_by(Cod) %>%
summarise(cantidad = n()),
x=~Cod,
y=~cantidad,
type="bar",
name="Viajes"
) %>%
add_trace(
data=data %>%
select(Cod,marge_venta) %>%
group_by(Cod) %>%
summarise(margen_venta = mean(marge_venta)),
x=~Cod,
y=~margen_venta,
type="scatter",
mode="lines+markers",
name="margen_venta",
yaxis="y2"
)
plot_ly(
data= data %>%
select(Cod,marge_venta) %>%
group_by(Cod) %>%
summarise(cantidad = n()),
x=~Cod,
y=~cantidad,
type="bar",
name="Viajes"
) %>%
add_trace(
data=data %>%
select(Cod,marge_venta) %>%
group_by(Cod) %>%
summarise(margen_venta = mean(marge_venta)),
x=~Cod,
y=~margen_venta,
type="scatter",
mode="lines+markers",
name="margen_venta",
yaxis="y2"
) %>%
layout(yaxis = list(title = 'Count'),
yaxis2 = ay)
data <- data %>%
mutate(marge_venta = (factura - (camion + pickup + moto)))
data <- data %>%
mutate(marge_venta_porcostos = (factura - (fijocamion + directocamion+ fijopickup +directopickup+ fijomoto+ directomoto)))
ay <- list(
tickfont = list(color = "orange"),
overlaying = "y",
side = "right",
title = "Total"
)
plot_ly(
data= data %>%
select(Cod,marge_venta) %>%
group_by(Cod) %>%
summarise(cantidad = n()),
x=~Cod,
y=~cantidad,
type="bar",
name="Viajes"
) %>%
add_trace(
data=data %>%
select(Cod,marge_venta) %>%
group_by(Cod) %>%
summarise(margen_venta = mean(marge_venta)),
x=~Cod,
y=~margen_venta,
type="scatter",
mode="lines+markers",
name="margen_venta",
yaxis="y2"
) %>%
layout(yaxis = list(title = 'Count'),
yaxis2 = ay)
